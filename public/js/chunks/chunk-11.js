webpackJsonp([11],{"+YpO":function(t,e,i){"use strict";var n=i("NYxO"),s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t};e.a={methods:s({},Object(n.mapActions)("subEvents",["clearForm"])),computed:s({},Object(n.mapState)({addresses:function(t){return t.addresses},events:function(t){return t.events},subEvents:function(t){return t.subEvents}}))}},"+gzN":function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"py-2 text-center"},[i("h1",[t._v("Convidar pessoas para o sub-evento")]),t._v(" "),i("h2",[t._v(t._s(t.events.selected.name))]),t._v(" "),i("h2",[t._v(t._s(t.subEvents.selected.name)+" - "+t._s(t.subEvents.selected.sector?t.subEvents.selected.sector.name:""))]),t._v(" "),i("h2",[t._v(t._s(t.subEvents.selected.place))])]),t._v(" "),i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-6"},[t.invitables.data.links?i("app-table-panel",{attrs:{title:"Pessoas","per-page":t.invitablesPerPage,"filter-text":t.invitablesFilterText},on:{"set-per-page":function(e){t.invitablesPerPage=e},"input-filter-text":function(e){t.invitablesFilterText=e.target.value}}},[i("template",{slot:"checkboxes"},[i("app-input",{attrs:{name:"not_invited",label:"Somente não convidados",type:"checkbox",required:!0,form:t.form,inline:"true"},model:{value:t.notInvited,callback:function(e){t.notInvited=e},expression:"notInvited"}})],1),t._v(" "),i("template",{slot:"selects"},[i("app-institution-filter-for-invitation",{attrs:{name:"institution_id",label:"Instituição",required:!0,form:t.form,options:t.environment.tables.institutions}}),t._v(" "),i("app-role-filter-for-invitation",{attrs:{name:"role_id",label:"Função",required:!0,form:t.form,options:t.environment.tables.roles}}),t._v(" "),i("app-select",{attrs:{name:"sub_event_id",label:"Filtrar convidados de outro sub-evento",required:!0,form:t.form,options:t.except(this.environment.tables.sub_events,this.subEvents.form.fields.id)},model:{value:t.subEventSelectFilter,callback:function(e){t.subEventSelectFilter=e},expression:"subEventSelectFilter"}})],1),t._v(" "),i("template",{slot:"buttons"},[i("div",{staticClass:"btn btn-primary btn-sm pull-right",on:{click:function(e){t.invite()}}},[t._v("\n                        "+t._s(t.recordButtonText)+"\n                    ")]),t._v(" "),t.selectedSubEvent?i("div",{staticClass:"btn btn-danger btn-sm pull-right",on:{click:function(e){t.moveInvitations()}}},[t._v("\n                        mover convidados\n                    ")]):t._e()]),t._v(" "),i("app-table",{attrs:{pagination:t.invitables.data.links.pagination,columns:["#","Convidar","Tratamento","Nome","Instituição","Cargo","Convidado",""]},on:{"goto-page":function(e){t.invitablesGotoPage(e)}}},t._l(t.invitables.data.rows,function(e){return i("tr",{class:{"cursor-pointer":!0,"bg-primary-lighter text-white":t.isCurrent(e,t.invitables.selected)}},[i("td",{staticClass:"align-middle"},[t._v(t._s(e.id))]),t._v(" "),i("td",{staticClass:"align-middle"},[e.is_invited_to_sub_event?t._e():i("input",{attrs:{type:"checkbox"},domProps:{checked:t.isChecked(e)},on:{input:function(i){t.toggleCheck(e)}}})]),t._v(" "),i("td",{staticClass:"align-middle"},[t._v(t._s(e.title))]),t._v(" "),i("td",{staticClass:"align-middle"},[t._v(t._s(e.person.name))]),t._v(" "),i("td",{staticClass:"align-middle"},[t._v(t._s(e.institution.name))]),t._v(" "),i("td",{staticClass:"align-middle"},[t._v(t._s(e.role.name))]),t._v(" "),i("td",{staticClass:"align-middle text-center"},[i("h6",{staticClass:"mb-0"},[e.is_invited_to_sub_event?i("span",{staticClass:"badge badge-success"},[t._v("Já convidado")]):t._e()])]),t._v(" "),i("td",{staticClass:"align-middle"},[t.can("update")?i("a",{staticClass:"btn btn-danger btn-sm ml-1 pull-right",attrs:{href:"#"},on:{click:function(i){t.invite(e)}}},[i("i",{staticClass:"fa fa-plus"})]):t._e()])])}),0)],2):t._e()],1)])])},staticRenderFns:[]}},"8nzx":function(t,e,i){"use strict";e.a={data:function(){return{loading:{environment:!1,table:!1}}},computed:{filterText:{get:function(){return this.$store.state[this.service.name].data.filter.text},set:function(t){return this.$store.dispatch(this.service.name+"/mutateSetQueryFilterText",t)}},emptyForm:function(){return this.$store.state[this.service.name].emptyForm},form:function(){return this.$store.state[this.service.name].form},selected:function(){return this.$store.state[this.service.name].selected},environment:function(){return this.$store.state.environment},pagination:function(){return this.$store.state[this.service.name].data.links?this.$store.state[this.service.name].data.links.pagination:{}},perPage:{get:function(){return this.pagination.per_page},set:function(t){this.$store.dispatch(this.service.name+"/setPerPage",t)}}},methods:{load:function(){return this.$store.commit(this.service.name+"/mutateSetPerPage",this.environment.user.per_page),this.$store.dispatch(this.service.name+"/load")},select:function(t){return this.$store.dispatch(this.service.name+"/select",t)},save:function(t){return this.$store.dispatch(this.service.name+"/save",t)},mutateSetErrors:function(t){this.$store.commit(this.service.name+"/mutateSetErrors",t)},mutateFormData:function(t){this.$store.commit(this.service.name+"/mutateFormData",t)},mutateSetFormField:function(t){this.$store.commit(this.service.name+"/mutateSetFormField",t)},mutateSetService:function(t){this.$store.commit(this.service.name+"/mutateSetService",t)},isLoading:function(){return this.loading.environment||this.loading.table},boot:function(){var t=this;this.mutateSetService(this.service),!this.service.hasOwnProperty("performLoad")||this.service.performLoad?this.load().then(function(){t.fillFormWhenEditing()}):this.fillFormWhenEditing(),this.$store.dispatch(this.service.name+"/subscribeToTableEvents")},fillFormWhenEditing:function(){var t=this,e="update"===this.mode?_.find(this.rows,function(e){return e.id===t.$route.params.id}):this.form?clone(this.emptyForm):{};this.mutateFormData(e),this.mutateSetErrors({}),this.fillAdditionalFormFields()},fillAdditionalFormFields:function(){},back:function(){this.$router.back()},saveModel:function(){var t=this;this.save(this.mode).then(function(){t.back(),t.clearForm()})},can:function(t){return t&&!1},cannot:function(t){return!can(t)},gotoPage:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(i=i||this.pagination).current_page!==t&&(t<1||t>i.last_page||this.$store.dispatch((e||this.service.name)+"/setCurrentPage",t))},isCurrent:function(t,e){return t.id===e.id},setPerPage:function(){this.$store.commit(this.service.name+"/mutateSetPerPage",this.environment.user.per_page)},getDataUrl:function(){return buildApiUrl(this.service.uri,this.$store.state)},getStoreUrl:function(){return buildApiUrl(this.service.uri,this.$store.state)},getUpdateStoreUrl:function(){return buildApiUrl(this.service.uri,this.$store.state)}},mounted:function(){this.boot()}}},WO5o:function(t,e,i){(t.exports=i("FZ+f")(!1)).push([t.i,"",""])},iWfd:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("8nzx"),s=i("+YpO"),r=i("NYxO"),o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},a={methods:o({},Object(r.mapActions)("invitables",["clearForm"])),computed:o({},Object(r.mapState)({invitables:function(t){return t.invitables}}))},c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},l={name:"invitables",uri:"events/{events.selected.id}/sub-events/{subEvents.selected.id}/invitations/invitables"};e.default={props:["mode"],mixins:[n.a,a,s.a],data:function(){return this.$store.dispatch("environment/loadSubEvents"),this.$store.dispatch("environment/loadRoles"),this.$store.dispatch("environment/loadInstitutions"),{service:l,checkedPeople:{}}},computed:c({},Object(r.mapState)({events:function(t){return t.events},subEvents:function(t){return t.subEvents}}),{notInvited:{get:function(){return this.$store.state.invitations.data.filter.checkboxes.not_invited},set:function(t){t?this.$store.commit("invitables/mutateFilterCheckbox",{field:"not_invited",value:this.subEvents.selected.id}):this.$store.commit("invitables/mutateFilterCheckbox",{field:"not_invited",value:null}),this.$store.dispatch("invitables/load")}},selectedSubEvent:{get:function(){return this.$store.state.invitables.data.filter.selects.sub_event}},recordButtonText:{get:function(){return this.selectedSubEvent?"copiar convidados":"convidar"}},invitablesFilterText:{get:function(){return this.$store.state.invitables.data.filter.text},set:function(t){return this.resetCheckedPeople(),this.$store.dispatch(this.service.name+"/mutateSetQueryFilterText",t)}},invitablesPerPage:{get:function(){return this.$store.state.invitables.data.links.pagination.per_page},set:function(t){return this.resetCheckedPeople(),this.$store.dispatch("invitables/setPerPage",t)}},subEventSelectFilter:{get:function(){var t=this;return _.debounce(function(){t.$store.state.invitables.data.filter.selects.sub_event},650)},set:function(t){return this.resetCheckedPeople(),this.$store.dispatch("invitables/mutateFilterSelect",{field:"sub_event",value:t})}}}),methods:{invitablesGotoPage:function(t){this.gotoPage(t,"invitables",this.invitables.data.links.pagination)},resetCheckedPeople:function(){for(var t in this.checkedPeople)this.checkedPeople.hasOwnProperty(t)&&(this.checkedPeople[t].checked=!1)},isChecked:function(t){return!!this.checkedPeople.hasOwnProperty(t.id)&&this.checkedPeople[t.id].checked},toggleCheck:function(t){this.checkedPeople.hasOwnProperty(t.id)||(this.checkedPeople[t.id]={id:t.id,checked:!1}),this.checkedPeople[t.id].checked=!this.checkedPeople[t.id].checked},invite:function(){var t={eventId:this.events.selected.id,subEventId:this.subEvents.selected.id,invitees:_.filter(this.checkedPeople,function(t){return t.checked})};this.resetCheckedPeople(),this.$store.dispatch("invitables/invite",t)},moveInvitations:function(){var t={eventId:this.events.selected.id,newSubEventId:this.subEvents.selected.id,currentSubEventId:this.selectedSubEvent,invitees:_.filter(this.checkedPeople,function(t){return t.checked})};this.resetCheckedPeople(),this.$store.dispatch("invitables/moveInvitations",t)},except:function(t){function e(e,i){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t,e){var i=clone(t);return i.rows=except(t.rows,e),i})}}},nY0I:function(t,e,i){var n=i("WO5o");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);i("rjj0")("4c9c52bd",n,!0,{})},sW6E:function(t,e,i){var n=i("VU/8")(i("iWfd"),i("+gzN"),!1,function(t){i("nY0I")},null,null);t.exports=n.exports}});